function initializeCheckboxes(){$("input:radio, input:checkbox").checkedPolyfill(),$("body").on("click",".checkbox input:checkbox",function(){$(this).is(":checked")?$(this).parent().addClass("chacked"):$(this).parent().removeClass("chacked")}),$(".checkbox input:checkbox").each(function(){$(this).is(":checked")?$(this).parent().addClass("chacked"):$(this).parent().removeClass("chacked")})}function checkFieldsGlobal(){function a(a){var b=a.split(".");b[1]-=1;var c=new Date(b[2],b[1],b[0]);return c.getFullYear()==b[2]&&c.getMonth()==b[1]&&c.getDate()==b[0]?!0:!1}function b(a){if(a.hasClass("requiredFieldsDate")){var b=a.val();this.isValidDate(b)===!1?a.closest(".btn_big_rounded").addClass("error_validation"):a.closest(".btn_big_rounded").removeClass("error_validation")}else a.hasClass("requiredFieldsSelect")?a.find("select").val()>0?a.removeClass("error_validation"):a.addClass("error_validation"):a.hasClass("requiredFieldsTitle")?a.text().length<4?a.addClass("error_validation"):a.removeClass("error_validation"):a.hasClass("requiredFieldsImage")?a.find("img").length?a.removeClass("error_validation"):a.addClass("error_validation"):a.hasClass("requiredFieldsCheckBox")?a.find('input[type="checkbox"]').is(":checked")?a.removeClass("error_validation"):a.addClass("error_validation"):a.val().length<4?a.addClass("error_validation"):a.removeClass("error_validation")}return{checkFields:b,isValidDate:a}}!function(a){a.fn.checkedPolyfill=function(b){function c(){var b,c=a('<style type="text/css"> #checkedPolyfill-test:checked { margin-left: 123456px; display: none; } </style>}'),d=a('<input type="checkbox" checked id="checkedPolyfill-test" />');return a("head").append(c),a("body").append(d),b="123456px"===d.css("margin-left")?!0:!1,c.remove(),d.remove(),b}function d(b){var c=a('label[for="'+b.attr("id")+'"]');return b.prop("checked")?(b.addClass("checked"),c.addClass("checked")):(b.removeClass("checked"),c.removeClass("checked")),b}return c()?!1:this.each(function(){var b=a(this);"radio"===b.prop("type")?a('input[name="'+b.prop("name")+'"]').change(function(){d(b)}):"checkbox"===b.prop("type")&&b.change(function(){d(b)}),d(b)})}}(jQuery),$(function(){function a(a){$(".comiseo-daterangepicker").css({top:a.offset().top+a.height(),left:a.offset().left+b,width:a.width()-2*b,"min-width":a.width()-2*b}),$(".datepicker_bottom_block").css({top:a.outerHeight()+$(".comiseo-daterangepicker").outerHeight(),left:b}),a.find(".calendar_block").show()}var b=19;$(".datepicker").length&&($(".datepicker").daterangepicker({datepickerOptions:{numberOfMonths:1,firstDay:1,maxDate:null,onSelect:function(a,b,c){var d="",e="";if(c.start){var f=("0"+c.start.getDate()).slice(-2),g=("0"+(c.start.getMonth()+1)).slice(-2),h=c.start.getFullYear();d=f+"."+g+"."+h}if(c.end){var i=("0"+c.end.getDate()).slice(-2),j=("0"+(c.end.getMonth()+1)).slice(-2),k=c.end.getFullYear();e=i+"."+j+"."+k}$(".calendarWrap.active").find(".calendar_from").val(d),$(".calendarWrap.active").find(".calendar_to").val(e),checkFieldsGlobal.checkFields($(".calendarWrap.active").find(".calendar_from")),checkFieldsGlobal.checkFields($(".calendarWrap.active").find(".calendar_to"))}}}),$(".calendarWrap").on("click",function(b){b.preventDefault();var c=$(this),d=c.find(".datepicker");c.addClass("active"),d.daterangepicker("open"),a(c)}),$(window).resize(function(){var b=$(".calendarWrap");a(b)}),$(document).scroll(function(){var b=$(".calendarWrap"),c=$(document).scrollTop();b=$(".calendarWrap.active").length?$(".calendarWrap.active"):$(".calendarWrap"),c>10&&a(b)}),$(".js-reset").on("click",function(){$(".calendarWrap.active").find(".datepicker").daterangepicker("clearRange"),$(".calendarWrap.active").find(".calendar_from").val(""),$(".calendarWrap.active").find(".calendar_to").val("")}))}),$(document).ready(function(){var a=($(this),$(".js-example-basic-single")),b=$(".js-approver_for_request"),c=$(".js-example-basic-multiple"),d=b.data("text");a.select2({minimumResultsForSearch:-1,escapeMarkup:function(a){return a}}),b.select2({minimumResultsForSearch:-1,placeholder:d,escapeMarkup:function(a){return a}}),c.select2({minimumResultsForSearch:-1,escapeMarkup:function(a){return a}})}),$(document).ready(function(){function a(){h.addClass("scroll"),i.addClass("scrollWrap"),l.addClass("navigation_dropdown_list_fixed_scroll")}function b(){h.removeClass("scroll"),i.removeClass("scrollWrap"),l.removeClass("navigation_dropdown_list_fixed_scroll")}function c(){o=!0,f.find(".navigation_dropdown_block_wrap").animate({opacity:0},m,function(){f.find(".navigation_dropdown_block").animate({height:[0,"easeInOutQuart"]},n,function(){f.removeClass("active"),o=!1})})}function d(a){o=!0,f.addClass("active"),f.find(".navigation_dropdown_block").animate({height:["396px","easeInOutQuart"]},m,function(){f.find(".navigation_dropdown_block_wrap").animate({opacity:1},n,function(){o=!1})})}var e=$(this),f=$(".navigation_dropdown",e),g=$(".navigation_dropdown_block",e),h=$("ul.menu"),i=$(".menu_scroll_wrap"),j=$(".header"),k=$(".element_header"),l=$(".navigation_dropdown_list_fixed"),m=500,n=200,o=!1;g.on("click",function(a){a.stopPropagation()}),$(document).scroll(function(){var c=$(document).scrollTop();$("body").hasClass("bigIndentScroll")?c>j.outerHeight()+k.outerHeight()?a():b():c>78?a():b()}),initializeCheckboxes(),$("body").on("click",".navigation_dropdown",function(a){if(!o){var b=$(a.currentTarget);b.hasClass("active")?c():d()}}),$("body").on("click",function(a){if(!o){var b=$(a.currentTarget);f.hasClass("active")&&(b.hasClass("navigation_dropdown_block")||g.has(b))&&c()}})});var checkFieldsGlobal=checkFieldsGlobal();$(function(){function a(){d.off("click"),d.remove(),i.removeClass("popup_active")}function b(){$(".requiredFields").each(function(){checkFieldsGlobal.checkFields($(this))})}function c(c){var j=_.template(g);d=$(j({data:c?c:{activity:{},toolbox:{},brand:{},accessManagement:{},adGroups:[]}}));var k=d.find("form");c&&c.id&&k.find('[name="adGroups"]').children().each(function(){var a=$(this);_.where(c.adGroups,a.val()).length&&a.attr("selected","selected")}),d.on("click",".btn-save",function(d){d.preventDefault();var g={id:c?c.id:null,name:k.find('[name="name"]').val(),activity:{view:k.find('[name="activityView"]').is(":checked"),change:k.find('[name="activityChange"]').is(":checked"),approve:k.find('[name="activityApprove"]').is(":checked")},toolbox:{view:k.find('[name="toolboxView"]').is(":checked"),change:k.find('[name="toolboxChange"]').is(":checked"),approve:k.find('[name="toolboxApprove"]').is(":checked")},brand:{view:k.find('[name="brandView"]').is(":checked"),change:k.find('[name="brandChange"]').is(":checked"),approve:k.find('[name="brandApprove"]').is(":checked")},accessManagement:{view:k.find('[name="accessManagementView"]').is(":checked"),change:k.find('[name="accessManagementChange"]').is(":checked"),approve:k.find('[name="accessManagementApprove"]').is(":checked")},adGroups:k.find('[name="adGroups"]').val()};$.ajax({url:k.attr("action"),type:"GET",dataType:"json",data:g,success:function(b){if(!$(".error_validation").length)if(a(),c&&c.id){var d=_.findIndex(accessManagementData,function(a){return a.id==c.id}),i=f.filter('[data-id="'+c.id+'"]');$.extend(accessManagementData[d],g),accessManagementData[d].adGroups=g.adGroups,i.find(".access-management-name").text(c.name),i.find(".access-management-activity-view").text(c.activity.view?"Yes":"No"),i.find(".access-management-activity-change").text(c.activity.change?"Yes":"No"),i.find(".access-management-activity-approve").text(c.activity.approve?"Yes":"No"),i.find(".access-management-ad-groups").html(c.adGroups?c.adGroups.join(", <br>"):""),i.find(".access-management-toolbox-view").text(c.toolbox.view?"Yes":"No"),i.find(".access-management-toolbox-change").text(c.toolbox.change?"Yes":"No"),i.find(".access-management-toolbox-approve").text(c.toolbox.approve?"Yes":"No"),i.find(".access-management-brand-view").text(c.brand.view?"Yes":"No"),i.find(".access-management-brand-change").text(c.brand.change?"Yes":"No"),i.find(".access-management-brand-approve").text(c.brand.approve?"Yes":"No"),i.find(".access-management-access-management-view").text(c.accessManagement.view?"Yes":"No"),i.find(".access-management-access-management-change").text(c.accessManagement.change?"Yes":"No"),i.find(".access-management-access-management-approve").text(c.accessManagement.approve?"Yes":"No")}else{g.id||(g.id=Math.random()+"");var j=_.template(h),k=j({data:b.data?b.data:g,isOdd:f.length%2==0});e.append(k),f=e.find(".access-management-item"),accessManagementData.push(b.data?b.data:g)}},error:function(a){alert("Something went wrong")}}),b()}),d.on("click",".btn-cansel",function(b){b.preventDefault(),a()}),i.addClass("popup_active").append(d),$(".js-example-basic-multiple").select2({minimumResultsForSearch:-1,escapeMarkup:function(a){return a}}),initializeCheckboxes()}var d,e=$(".access-management-block"),f=e.find(".access-management-item"),g=$("#popup-acces-managment-tpl").html(),h=$("#popup-acces-item-tpl").html(),i=$("#popup_block");$(".requiredFields");$(".requiredFields").on("change",function(){checkFieldsGlobal.checkFields($(this))}),$("body").on("change","[contenteditable]",function(){var a=$(this);return a.data("before",a.html()),a}).on("blur keyup paste input","[contenteditable]",function(){var a=$(this);return a.data("before")!==a.html()&&(a.data("before",a.html()),a.trigger("change")),a}),e.on("click",".btn_delete",function(a){a.preventDefault();var b=$(a.currentTarget).closest(".access-management-item"),c=b.data("id");$.ajax({url:"/request.json",type:"GET",dataType:"json",data:{id:c},success:function(){var a=_.findIndex(accessManagementData,function(a){return a.id==c});accessManagementData.splice(a,1),b.remove(),f=e.find(".access-management-item")},error:function(){alert("Something went wrong")}})}),e.on("click",".btn_edit",function(a){a.preventDefault();var b=$(a.currentTarget).closest(".access-management-item").data("id")+"",d=_.where(accessManagementData,{id:b})[0];c(d)}),$(".btn-add-role").on("click",function(a){a.preventDefault(),c()}),i.on("click","#popup_fone",function(){d&&d.length&&a()}),$("body").on("keyup",".requiredFields",function(){$(this).hasClass("requiredFieldsTitle")||($(this).val().length<4?$(this).addClass("error_validation"):$(this).removeClass("error_validation"))}),$("form").on("submit",function(a){b(),$(".error_validation").length&&a.preventDefault()})}),$(function(){$(document).on("click",function(a){$(".status_wrap")})}),$(function(){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&($(".channel:nth-child(2n+1)").addClass("odd"),$(".document:nth-child(2n+1)").addClass("odd"))}),$(function(){var a=$(this);$tabsNav=$(".tabs_nav",a),$tabsNavItems=$tabsNav.find("li"),$tabsContentWrap=$(".tabs_content"),idx=0,idxFix=0,$tabsNavItems.each(function(a,b){$(this).parent().hasClass("js-tabs_nav_fix")?($(this).attr("data-page",idxFix),idxFix++):($(this).attr("data-page",idx),idx++)}),$tabsNavItems.on("click",function(a){a.preventDefault();var b=$(this),c=$(".tabs_content");idx=b.data("page"),b.addClass("active").siblings().removeClass("active"),c.find("> li").eq(idx).addClass("active").siblings().removeClass("active"),b.parent().hasClass("js-tabs_nav_fix")?b.closest(".tabs_content_wrap").prev(".header").find(".tabs_nav li").each(function(){$(this).data("page")==b.data("page")?$(this).addClass("active"):$(this).removeClass("active")}):b.closest(".header").next(".tabs_content_wrap").find(".tabs_nav li").each(function(){$(this).data("page")==b.data("page")?$(this).addClass("active"):$(this).removeClass("active")})})}),$(function(){}),$(function(){}),$(function(){}),$(function(){function a(){d.off("click"),d.remove(),e.removeClass("popup_active")}function b(){$(".requiredFields").each(function(){$(this).val().length<4?$(this).addClass("error_validation"):$(this).removeClass("error_validation")})}function c(c){var j=_.template(f);d=$(j({data:c?c:{}}));var k=d.find("form");d.on("click",".btn-save",function(d){d.preventDefault();var e={id:c?c.id:null,subject:k.find('[name="subject"]').val(),text:k.find('[name="text"]').val()};$.ajax({url:k.attr("action"),type:"GET",dataType:"json",data:e,success:function(b){if(!$(".error_validation").length)if(a(),c&&c.id){var d=_.findIndex(emailNotificationsData,function(a){return a.id==c.id}),f=i.filter('[data-id="'+c.id+'"]');$.extend(emailNotificationsData[d],e),f.find(".email-notification-label").text(c.label),f.find(".email-notification-subject").text(c.subject),f.find(".email-notification-text").text(c.text)}else{e.id||(e.id=Math.random()+"");var j=_.template(g),k=j({data:b.data?b.data:e,isOdd:i.length%2==0});h.append(k),i=h.find(".email-notification-item"),emailNotificationsData.push(b.data?b.data:e)}},error:function(a){alert("Something went wrong")}}),b()}),e.addClass("popup_active").append(d)}var d,e=$("#popup_block"),f=$("#edit-notification-tpl").html(),g=$("#email-notification-item-tpl").html(),h=$(".email-notification-block"),i=h.find(".email-notification-item");$(".btn-add-notification").on("click",function(a){a.preventDefault(),c()}),h.on("click",".btn-edit",function(a){a.preventDefault();var b=$(a.currentTarget).closest(".email-notification-item").data("id")+"",d=_.where(emailNotificationsData,{id:b})[0];c(d)}),e.on("click","#popup_fone",function(){d&&d.length&&a()})}),$(function(){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&$(".wrap_table > div:nth-child(odd)").addClass("odd")}),$(function(){var a=$(".js-uploader");$(".js-basket");a.each(function(){var a=$(this),b=a.text(),c="/img/parlament_bg.jpg",d="123",e="Tititi";new qq.FileUploader({element:this,action:"/server/upload",uploadButtonText:b,allowedExtensions:["jpg","jpeg","png","gif"],onSubmit:function(){a.text("Uploading...")},onComplete:function(f,g,h){if(a.text(b),a.parent().hasClass("block_img"))a.hide(),a.closest(".block_img").append('<img src="'+c+'" alt="">'),a.closest(".requiredFields").removeClass("error_validation");else{var i=_.template($("#template").html());a.closest("form").find(".attachments_block_wrap").append(i({url:c,size:d,name:e}))}}})}),$(".block_img").on("click","img",function(a){a.preventDefault(),$(this).closest(".block_img").find(".js-uploader").trigger("click")}),$("body").on("click",".js-basket",function(a){a.preventDefault(),$(this).closest(".block").remove()}),$(document).on("click",function(a){$(".status_wrap")})}),$(function(){function a(a){return/^[a-zA-Z0-9_\-\.]+@[a-zA-Z0-9\-]+\.[a-zA-Z0-9\-\.]+$/.test(a.val())?void a.removeClass("error_validation").addClass("complete"):(a.focus(),a.addClass("error_validation").removeClass("complete"),!1)}var b=$(".js-mail");b.on("change",function(){var b=$(this);a(b)})}),$(function(){function a(a){return""==a.val()?(a.focus(),a.addClass("error_validation"),!1):a.val().length<4?(a.focus(),a.addClass("error_validation"),!1):/^[a-zA-Z0-9]+$/.test(a.val())?void 0:(a.focus(),a.addClass("error_validation"),!1)}function b(a,b){return""==a.val()||""==b.val()?(b.focus(),!1):void(a.val()!==b.val()?(a.addClass("error_validation"),a.removeClass("complete"),b.addClass("error_validation"),b.removeClass("complete")):(a.removeClass("error_validation"),a.addClass("complete"),b.removeClass("error_validation"),b.addClass("complete")))}var c=$(".password_wrap input");c.on("change",function(){var c=$(this),d=c.parent().siblings("div").find("input");a(c),b(c,d)})}),$(document).ready(function(){var a=$(this);$tabsNav=$(".js-tabs_nav",a),$tabsNavItems=$tabsNav.find("option"),$tabsContentWrap=$(".js-tabs_content"),$searchBlockWrapper=$(".search_block_wrapper"),$searchBlock=$searchBlockWrapper.find(".search_block_wrap"),speed=700,speedFast=100,animationBlock=!1,idx=0,$activeForm=$tabsContentWrap.find("> li").eq(idx),activeFormHeight=$activeForm.outerHeight(),$tabsNav.on("change",function(a){a.preventDefault();var b=$(this),c=(b.val(),20);$activeForm.animate({height:0},speedFast,function(){$activeForm.addClass("active").siblings().removeClass("active"),$tabsContentWrap.animate({"z-index":1,height:activeFormHeight+c},speed),$activeForm.animate({height:activeFormHeight+c},speed),animationBlock=!1})}),$(".ico_star").click(function(){$(this).toggleClass("active")})}),$(document).ready(function(){function a(a,b){a.animate({height:b+j},g,function(){i=!1})}var b=$(".ico_star"),c=$(".js_search"),d=($(".js-activities-search"),$(".search_block_wrapper")),e=d.find(".js-tabs_content li.active"),f=($(".menu_scroll_wrap"),$(".js-btn_select")),g=(e.outerHeight(),500),h=300,i=!1,j=20;b.on("click",function(){$(this).toggleClass("active")}),c.on("click",function(){var b=$(this),c=b.closest("body").find(".js-form_search-wrap"),e=c.find(".search_block_wrap").outerHeight();b.toggleClass("active"),f.toggleClass("active"),$("body").animate({scrollTop:d.offset().top},h,function(){b.hasClass("active")?a(c,e):a(c,-j)})}),f.on("click",function(){var b=$(this),d=b.closest(".search_block_wrapper").next(".content_wrap.bg_gray").find(".js-form_search-wrap"),e=d.find(".search_block_wrap").outerHeight();b.toggleClass("active"),c.toggleClass("active"),b.hasClass("active")?a(d,e):a(d,-j)})}),$(function(){var a=$(".js-uploader-image"),b=$(".js-img_wrap");a.each(function(){var a=$(this),b=a.text(),c="/img/parlament_bg.jpg";new qq.FileUploader({element:this,action:"/server/upload",uploadButtonText:b,allowedExtensions:["jpg","jpeg","png","gif"],onSubmit:function(){a.text("Uploading...")},onComplete:function(){a.text(b),a.hide(),a.closest(".js-img_wrap").append('<img src="'+c+'" alt="">')}})}),b.on("click","img",function(a){a.preventDefault(),$(this).closest(".js-img_wrap").find(".js-uploader").trigger("click")})}),$(document).ready(function(){$("body").on("click",".js-basket",function(a){a.preventDefault(),$(this).closest(".block").remove()})}),$(document).ready(function(){$(".ico_star").click(function(){$(this).toggleClass("active")})});